CREATE TABLE `chat_logs` (
`id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`agentid` INT NOT NULL ,
`clientusername` VARCHAR( 64 ) NOT NULL ,
`submittime` DATETIME NOT NULL ,
`conversation` TEXT NOT NULL
) ENGINE = MYISAM CHARACTER SET ascii COLLATE ascii_bin;
CREATE VIEW `view_chat_logs` AS
select 
	`b`.`companyid` AS `companyid`,`c`.`officename` AS `officename`,`a`.`agentid` AS `agentid`,
	`d`.`username` AS `username`,`d`.`username4m`,`a`.`clientusername` AS `clientusername`,
	concat(left(`a`.`conversation`,500),'\r\n...') AS `conversation`,
	`a`.`submittime` AS `submittime`
from (((`chat_logs` `a` join `trans_agents` `b`) join `trans_companies` `c`) join `trans_accounts` `d`)
where ((`a`.`agentid` = `b`.`id`) and (`b`.`companyid` = `c`.`id`) and (`b`.`id` = `d`.`id`));